<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>大朴</title>
    <link rel="stylesheet" href="car.css">
</head>

<body>
    <div id="head">
        <div class="head">
            <p class="head1" id="jump">
            </p>
            <p class="head2">
                <input type="text" name="" id="put1" placeholder="商品搜索">
                <input type="text" name="" id="put2">
                <span>
                    <a id="login" href="/project/login.html">登录 </a> &nbsp |
                    <a id="registered" href="">注册 </a>
                </span>
            </p>
        </div>
    </div>
    <div id="nav">
        <ul class="navul">
            <li>
                <a href="">首页</a>
            </li>
            <li>
                <a href="">生活家电</a>
            </li>
            <li class="li1">
                <a href="">大朴床品</a>
                <ol class="li1hover">
                    <li>
                        <a href="">
                            <b>床品件套</b>
                        </a>
                        <span>婚庆件套</span>
                        <span>件套</span>
                        <span>床单/床笠</span>
                        <span>枕巾枕套</span>
                        <span>被罩</span>
                        <span>靠垫/靠垫套</span>
                    </li>

                    <li>
                        <a href="">
                            <b>被子枕头</b>
                        </a>
                        <span>被子</span>
                        <span>枕头</span>
                        <span>床垫</span>
                        <span>夏凉被</span>
                    </li>
                    <li>
                        <a href="">
                            <b>夏凉床品</b>
                        </a>
                        <span>老粗布系列</span>
                        <span>亚布系列</span>
                        <span>蔺草席</span>
                        <span>蚊帐</span>
                    </li>
                </ol>



            </li>
            <li>
                <a href="">毛巾&浴巾</a>
            </li>
            <li>
                <a href="">拖鞋&袜子</a>
            </li>
            <li>
                <a href="">家居服饰</a>
            </li>
            <li>
                <a href="">清洁日用</a>
            </li>
            <li>
                <a href="">内衣&内裤</a>
            </li>
            <li>
                <a href="">婴童用品</a>
            </li>
        </ul>

    </div>



    <!-- 中间部分 -->
    <div id="crumb">
        <div class="crumb">
            <ul>
                <li>首页
                    <span> > </span>
                </li>
                <li>卧室用品
                    <span> > </span>
                </li>
                <li>夏凉床品
                    <span> > </span>
                </li>
                <li>夏凉被/毯子
                    <span> > </span>
                </li>
                <li>棉麻褶皱毛巾被</li>
                <li></li>
            </ul>
        </div>
    </div>

    <!-- 商品图片 -->


    <div id="main">
        <div class="main">
            <!-- 左边图片内容 -->
            <div class="picture">
                <!-- 大图 -->
                <div class="mainpicture">
                    <img src="" alt="" style="width: 350px;height: 350px;">
                    <div class="smalldiv">

                    </div>
                </div>
                <!-- 小图 -->
                <div class="smallpicture">

                    <ul>
                        <p></p>
                        <li class="li1">
                            <img src="" alt="" style="width: 40px;height: 40px;">
                        </li>
                        <li class="li2">
                            <img src="" alt="" style="width: 40px;height: 40px;">

                        </li>
                        <li class="li3">
                            <img src="" alt="" style="width: 40px;height: 40px;">

                        </li>
                        <li class="li4">
                            <img src="" alt="" style="width: 40px;height: 40px;">

                        </li>
                        <li class="li5">
                            <img src="" alt="" style="width: 40px;height: 40px;">

                        </li>
                        <li class="li6">
                            <img src="" alt="" style="width: 40px;height: 40px;">

                        </li>
                        <p></p>
                    </ul>



                    <!-- 收藏  分享 -->
                    <div class="small">
                        <ul>
                            <li>
                                <span> 收藏</span>
                            </li>
                            <li>
                                <span> 分享</span>
                            </li>
                        </ul>
                    </div>
                </div>


            </div>
            <div class="bigdiv">
                <img src="http://p1.dapuimg.com/public/images/0d/71/b8/ce4274ecb7eb1351d7d3a0b56a662326.jpg?1586835538#h" alt="">
            </div>
            <!-- 图片右边详情 -->
            <div class="side">
                <p class="p1"></p>
                <p class="p2"> 商品编号：
                    <span>

                    </span>
                </p>
                <p class="p3"></p>
                <p class="p4">
                    <span class="span1">会员价</span>
                    <span class="span6"> </span>
                    <span class="span2">如何成为会员</span>
                </p>
                <p class="p5">
                    <span class="span3">促销</span>
                    <span class="span7">
                        满88包邮
                    </span>
                </p>
                <div class="div1">
                    <li>
                        <p class="p6"></p>
                        <p class="p7">销量</p>
                    </li>
                    <li class="li1">
                        <p class="p8"></p>
                        <p class="p9">用户评论数</p>
                    </li>
                    <li class="li2">
                        <p class="p10" style="border: none;"></p>
                        <p class="p11" style="border: none;">评论送积分</p>
                    </li>
                </div>
                <span class="span4">棉麻混纺工艺，富有肌理感的褶皱提花设计，既保留棉的舒适柔软，又增加麻的挺爽透湿。</span>
                <div class="div2">
                    <span class="span5">颜色：</span>

                    <li class="li3">本白</li>
                    <li class="li4">麻灰</li>
                    <li class="li5">浅棕</li>
                    <li class="li6">豆绿</li>


                </div>
                <div class="div3">
                    <span class="span5">数量</span>
                    <li class="li7">-</li>
                    <p class="p12">
                        <span class="span5">1</span>
                    </p>
                    <li class="li8">+</li>
                </div>
                <div class="div4">
                    加入购物车

                </div>
            </div>
        </div>



    </div>
























    <!--尾部导航 -->
    <div id="tail">
        <div class="tail">
            <div class="tail1">
                <ul>
                    <li>关于大朴</li>
                    <li>|</li>
                    <li>联系我们</li>
                    <li>|</li>
                    <li>常见问题产品查询</li>
                    <li>|</li>
                    <li>手机大朴</li>
                    <li>|</li>
                    <li>
                        <select name="" id="">
                            <option value="1">语言选择</option>
                            <option value="2">English</option>
                            <option value="3">日语</option>
                            <option value="3">Deutsh</option>
                        </select>
                    </li>
                </ul>
                <p class="centertail1">Copyright © 2013-2018 dapu.com 北京大朴至向家居设计有限公司 </p>
                <p class="centertail12">京ICP备12027522号 京ICP证130030号</p>
                <p class="centertail13">企业资质</p>
                <p class="centertail14">京公网安备 11010502030202号</p>
            </div>
            <div class="tail2">
            </div>
            <div class="tail3">
                <p></p>
                <span>大朴微信公众号</span>
            </div>
        </div>

    </div>

    <!-- 右边 -->
    <div id="sidebar">
        <div class="sidebar">
            <p class="sidebarp1"></p>
            <p class="sidebarp2"></p>
            <p class="sidebarp3">
            </p>
            <p class="sidebarp4"></p>
            <a href="#jump">
                <p class="sidebarp5"></p>
            </a>



            <div class="sidebardiv" class="sidebardiv2"> </div>






        </div>

    </div>

    <button id="but">点击刷新</button>



    <section id="section">
        <section class="section">

            <p class="p1">成功加入购物车</p>
            <p class="p2">目前选购商品共
                <span class="span1">1</span> 件 合计￥
                <span class="span2">199</span>
            </p>
            <p class="p3">继续购物</p>
            <p class="p4">去结算</p>
        </section>



    </section>






</body>

</html>
<script src="JS/jquery.min.js">

</script>
<script>
    let n = 1

    $(".li1").mouseenter(function () {
        console.log(2)
        $(".li1hover").addClass("li1hover1")
    })


    $(".li1").mouseleave(function () {

        $(".li1hover").removeClass("li1hover1")
    })





    //右侧的侧边栏
    $(".sidebarp1").mouseenter(function () {
        $(".sidebarp1").html("首页")
        $(".sidebarp1").click(function () {

            history.go(0)
            console.log(5)
        })
    })
    $(".sidebarp1").mouseleave(function () {
        $(".sidebarp1").html("")
    })
    $(".sidebarp2").mouseenter(function () {
        $(".sidebarp2").html("我的订单")
    })
    $(".sidebarp2").mouseleave(function () {
        $(".sidebarp2").html("")
    })

    $(".sidebarp3").mouseenter(function () {
        $(".sidebarp3").html("购物")
    })
    $(".sidebarp3").mouseleave(function () {
        $(".sidebarp3").html("")
    })

    $(".sidebarp4").mouseenter(function () {
        $(".sidebarp4").html("客服")
        $(".sidebardiv").addClass("sidebardiv2")
    })
    $(".sidebarp4").mouseleave(function () {
        $(".sidebarp4").html("")
        $(".sidebardiv").removeClass("sidebardiv2")
    })

    $(".sidebarp5").mouseenter(function () {
        $(".sidebarp5").html("回到顶部")
    })
    $(".sidebarp5").mouseleave(function () {
        $(".sidebarp5").html("")
    })

    //向后台发送请求


    let as = window.location.search.split("=")
    let goodsId = as[1]


    let http = new XMLHttpRequest()
    http.open("get", "http://192.168.1.4/project/car.php?goodsId=" + goodsId)
    http.send()
    http.onreadystatechange = function () {
        if (http.readyState === 4) {
            let as = http.responseText
            // console.log(http.responseText)
            let json = JSON.parse(as)
            console.log(json)
            // console.log(json.goodsImg)
            //图片

            $(".mainpicture").find("img").attr("src", json.goodsImg)
            $(".smallpicture .li1").find("img").attr("src", json.goodsImg)
            $(".smallpicture .li2").find("img").attr("src", json.beiyong1)
            $(".smallpicture .li3").find("img").attr("src", json.beiyong2)
            $(".smallpicture .li4").find("img").attr("src", json.beiyong3)
            $(".smallpicture .li5").find("img").attr("src", json.beiyong1)
            $(".smallpicture .li6").find("img").attr("src", json.beiyong2)
            //右边字
            $(".side .p1").html(json.goodsName)//商品名称
            $(".side .p2 span").html(json.beiyong4)//商品编号
            $(".side .p3 ").html("￥" + json.beiyong5)//价格
            $(".side .p4 .span6 ").html("￥" + json.beiyong6)//会员价格
            $(".side .div1 .p6 ").html(json.beiyong7)//评销量
            $(".side .div1 .p8 ").html(json.beiyong8)//评论数
            $(".side .div1 .p10 ").html(json.beiyong9)//积分
            // $(".side .div4 img").attr("id", json.goodsId)
            $(".side .div4 a").attr("href", "shopping.html?id=" + goodsId)

        }


    }
    //点击数量添加
    $(".side .li8").click(function () {
        n = n + 1
        $(".side .div3 .p12 span").html(n)
    })
    //点击数量添加
    $(".side .li7").click(function () {
        n = n - 1
        $(".side .div3 .p12 span").html(n)
        if (n < 1) {
            n = 0
        }
    })
    $(".side .div2 li").click(function () {
        $(".side .div2 li").removeClass("li")
        $(this).addClass("li")
        console.log(8)
    })

    //判断小图是否有图片
    // if (!$(".picture .smallpicture li img").attr("src")) {
    //     $(".picture .smallpicture li img").attr("src").remove()
    //     console.log(2)
    // }
    // else{
    //     console.log(4)
    // }


    //鼠标移上小图  改变大图图片
    $(".picture .smallpicture li img").mouseenter(function () {
        //获取图片的路径 

        let as = this.getAttribute("src")
        $(this).closest(".picture").find(".mainpicture img").attr("src", as)

    })

    //放大镜
    $(".mainpicture img").mouseenter(function () {
        let aa = this.getAttribute("src")
        $(".bigdiv img").attr("src", aa)

        $(".smalldiv").addClass("divsmall")
        $(".bigdiv").addClass("divbig")
    })

    $(".mainpicture img").mouseleave(function () {
        $(".smalldiv").removeClass("divsmall")
        $(".bigdiv").removeClass("divbig")
    })



    //获取放大镜的节点列表
    let smalldiv = document.querySelector(".smalldiv")
    let bigdiv = document.querySelector(".bigdiv")
    let mainpicturimg = document.querySelector(".mainpicture img")
    let bigdivimg = document.querySelector(".bigdiv img")


    // let bigdivimg = $(".mainpicture").find("img").attr("src")
    // $(".bigdiv img").attr("src",bigdivimg)

    $(".mainpicture img").mousemove(function (event) {
        // console.log($(".mainpicture").find("img").attr("src"))


        //阴影盒子X轴坐标 等于 鼠标距离左边距离-阴影宽度的一半
        smalldiv.style.left = event.offsetX - smalldiv.offsetWidth / 2 + "px"
        //阴影盒子top值 等于 鼠标距离上边边距离-阴影高度的一半
        smalldiv.style.top = event.offsetY - smalldiv.offsetHeight / 2 + "px"
        //看鼠标滑过时XY值占大图片的百分之多少
        let a = event.offsetX / mainpicturimg.offsetWidth
        let b = event.offsetY / mainpicturimg.offsetHeight
        // console.log(a)

        //bigdiv.offsetWidth/300px  放大图片的宽度的的一半

        bigdivimg.style.left = -bigdivimg.offsetWidth * a + bigdiv.offsetWidth / 2 + "px"
        bigdivimg.style.top = -bigdivimg.offsetHeight * b + bigdiv.offsetHeight / 2 + "px"

        // 判断X轴右边边界     如果大盒子宽度 小于等于 鼠标距离左边的距离与鼠标到阴影右边的的距离
        if (mainpicturimg.offsetWidth <= smalldiv.offsetWidth / 2 + event.offsetX) {
            //   阴影盒子的X轴 = 大盒子宽度-小盒子阴影宽度
            smalldiv.style.left = mainpicturimg.offsetWidth - smalldiv.offsetWidth + "px"
            //放大图片的X轴=   -2400     +600 
            bigdivimg.style.left = -bigdivimg.offsetWidth + bigdiv.offsetWidth + "px"
        }


        // 判断Y轴下边边界     如果大盒子高度 小于等于 鼠标距离上边边的距离与鼠标到阴影下边的的距离
        if (mainpicturimg.offsetHeight - smalldiv.offsetHeight / 2 - event.offsetY <= 0) {
            //   阴影盒子的Y轴 = 大盒子高度-小盒子阴影高度
            smalldiv.style.top = mainpicturimg.offsetHeight - smalldiv.offsetHeight + "px"
            //放大图片的Y轴=   -2400+600 
            bigdivimg.style.top = -bigdivimg.offsetHeight + bigdiv.offsetHeight + "px"
        }
        //判断X轴左边边界       判断鼠标到左侧边缘的距离是不是小于阴影盒子宽度的一般
        if (event.offsetX <= smalldiv.offsetWidth / 2) {

            smalldiv.style.left = 0 + "px"
            bigdivimg.style.left = 0 + "px"
        }
        // 判断Y轴上边边界
        if (event.offsetY <= smalldiv.offsetHeight / 2) {
            smalldiv.style.top = 0 + "px"
            bigdivimg.style.top = 0 + "px"
        }


    })


    //点击添加到购物车

    $(".side .div4").click(function () {
        let number = $(".side .p12 .span5").html()

        let http = new XMLHttpRequest()
        http.open("get", "http://192.168.1.4/project/carshopping.php?goodsId=" + goodsId + "&goodsCount=" + number + "&vipName=7897456")
        http.send()
        http.onreadystatechange = function () {
            if (http.readyState === 4) {
                if (http.responseText) {
                    console.log(http.responseText)
                    $(".section").addClass("section1")
                    //点击继续购物
                    $(".section .p3").click(function () {
                        console.log(2)
                        $(".section").removeClass("section1")
                    })
                    //点击去结算
                    $(".section .p4").click(function () {
                        console.log(4)
                        location.href = "http://192.168.1.4/project/shopping.html?vipName=7897456"

                    })






                }
            }
        }

    })





</script>